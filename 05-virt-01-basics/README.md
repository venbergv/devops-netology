
# Домашнее задание к занятию "5.1. Введение в виртуализацию. Типы и функции гипервизоров. Обзор рынка вендоров и областей применения."

---

## Задача 1

Опишите кратко, как вы поняли: в чем основное отличие полной (аппаратной) виртуализации, паравиртуализации и виртуализации на основе ОС.

---

Ответ.

1. Аппаратная виртуализация - предполагает работу виртуальной машины через гипервизор системы виртуализации с аппаратными ресурсами хоста. Виртуальные машины полностью изолированы друг от друга и от аппаратных ресурсов хоста.  
2. Паравиртуализация - предполагает возможность работы виртуальной машины напрямую с ресурсами хоста, через частично модифицированное ядро гостевой ос. Доступ к ресурсам хоста предоставляет гипервизор через API. Из-за необходимости изменения ядра гостевой ОС, эта технология имеет применение для ОС с открытым исходным кодом. Технология развивается в XEN.  
3. Виртуализация на основе ОС - предполагает разделение ресурсов одной операционной системы, установленной на хост виртуализации, между изолированными окружениями, с собственным пространством процессов и сетевым стеком.Технология представлена в OpenVZ, LXC и  других системах контейнеризации.  

---
## Задача 2

Выберите один из вариантов использования организации физических серверов, в зависимости от условий использования.

Организация серверов:
- физические сервера,
- паравиртуализация,
- виртуализация уровня ОС.

Условия использования:
- Высоконагруженная база данных, чувствительная к отказу.
- Различные web-приложения.
- Windows системы для использования бухгалтерским отделом.
- Системы, выполняющие высокопроизводительные расчеты на GPU.

Опишите, почему вы выбрали к каждому целевому использованию такую организацию.

---

Ответ.

*1. - Высоконагруженная база данных, чувствительная к отказу.*  

Для высоконагруженных баз данных любые накладные расходы на виртуализацию будут уменьшать производительность.  

Выбираем - *физические сервера.*  

*2. - Различные web-приложения.* 

Сами Web-приложения исполняются web-сервером. Возможно для некоторых требуются особые настройки окружения, но нет требований к разным ядрам ОС. Часто требуют быстрого масштабирования при возрастающей нагрузке. В большинстве случаев поддаются контейнеризации.  

Выбираем - *виртуализация уровня ОС.*

*3. - Windows системы для использования бухгалтерским отделом.*  

Хорошим решением могла бы быть VDI система. Обязательно надо оговаривать необходимость использования дополнительного оборудования, например кассового, или USB-специфических устройств. Т.к. они почти всегда необходимы. Отличным выбором была бы аппаратная виртуализация 1 или 2 типа. Но в выборе их нет.  

Выбираем - *физические сервера.* Но! Как частное мнение, рекомендую *аппаратную виртуализацию*, которая отсутствует в выборе.  

*4. - Системы, выполняющие высокопроизводительные расчеты на GPU.*  

Целью является продуктивное использование аппаратных ресурсов GPU для высокопроизводительных расчетов. Не обнаружил поддержки современных карт NVIDIA, предназначенных для расчетов, в гипервизоре XEN. При этом котейнеризация приложений для расчетов не ограничивает возможность использования GPU на аппаратном хосте. По принцыпу минимизации расходов предлагаю использовать виртуализацию уровня ОС. Если сама "система, выполняющие высокопроизводительные расчеты на GPU", поддерживает такую возможность. Иначе такую "систему, выполняющию высокопроизводительные расчеты на GPU" рекомендовал бы разместить на аппаратной виртуализации 1 или 2 типа. Но в выборе их нет.

Выбираем - *виртуализация уровня ОС.*

---
## Задача 3

Выберите подходящую систему управления виртуализацией для предложенного сценария. Детально опишите ваш выбор.

Сценарии:

1. 100 виртуальных машин на базе Linux и Windows, общие задачи, нет особых требований. Преимущественно Windows based инфраструктура, требуется реализация программных балансировщиков нагрузки, репликации данных и автоматизированного механизма создания резервных копий.
2. Требуется наиболее производительное бесплатное open source решение для виртуализации небольшой (20-30 серверов) инфраструктуры на базе Linux и Windows виртуальных машин.
3. Необходимо бесплатное, максимально совместимое и производительное решение для виртуализации Windows инфраструктуры.
4. Необходимо рабочее окружение для тестирования программного продукта на нескольких дистрибутивах Linux.

---

Ответ.

*Сценарий 1.*  
Так как преимущественно Windows based инфраструктура, то считаю логичным использовать Hyper-V Server - как систему виртуализации. Microsoft System Center - как систему управления, в том числе виртуализацией. А для репликации данных и автоматического создания резервных копий - замечательно подойдет Veeam Backup&Replication.  

*Сценарий 2.*  
Рабочим решением было бы использовать Linux KVM. Например - Proxmox CE.

*Сценарий 3.*  
Подходящим решением предлагаю выбрать Hyper-V Server. Т.к. это решение будет максимально совместимо c Window инфраструктурой. И в существующей Windows инфраструктуре возможно найдется Windows машина для управления самим Hyper-V Server. Т.к. Windows Admin Center не всегда справляется со своими задачами.  

*Сценарий 4.*  
1)Рабочим решением было бы использовать Linux KVM. Например - Proxmox CE.  
2)При необходимости большей совместимости с разными ОС Linux и максимизации использования ресурсов хота - возможно подойдет ESXi free. Но нужно строго соблюдать HCL и ознакомится с ограничениями бесплатной версии.  
3)Так же возможен вариант использования VirtualBox и готовых сценариев vagrant, если нет требований к высокой производительности VM.

---
## Задача 4

Опишите возможные проблемы и недостатки гетерогенной среды виртуализации (использования нескольких систем управления виртуализацией одновременно) и что необходимо сделать для минимизации этих рисков и проблем. Если бы у вас был выбор, то создавали бы вы гетерогенную среду или нет? Мотивируйте ваш ответ примерами.

---

Ответ.

---

1. Уменьшаем консолидацию аппаратных ресурсов жестко разделяя их между разными средами виртуализации.  
2. При раздельных системах управления так же понадобятся раздельные настройки систем мониторинга и резервного копирования.  
3. Обязательно нужны специалисты с компетенциями в каждой из используемых систем виртуализации.  

Выбор используемой системы виртуализации зависит от задач и доступных ресурсов.  
При наличии HA кластера ESXi под продуктивную среду, вполне допускаю использовать нескольких тестовых KVM хостов для тестирования ПО и обновлений ОС.

